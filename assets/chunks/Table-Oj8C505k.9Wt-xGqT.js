import{aY as xe,d as Te,N as Ae,h as E,G as Oe,a0 as L,y as ee,a7 as Pe,aW as Be,j as Ke,A as Re,z as Fe,D as le,az as Me,o as x,c as F,k as M,n as te,m as T,r as D,I as ae,e as H,ad as De,b as q,w as _e,F as ke,J as Ne,E as ze,M as ne,O as Ie,a5 as je,a6 as Ee,a4 as U,P as Le,an as He}from"./framework.3pdiJKKl.js";import{$ as qe,a1 as oe,a0 as ie,a4 as Q}from"./index-7YPWcIce.eAhqdqSk.js";import{b as Ue,k as We,g as re,c as Qe,s as Ve,u as Je,h as Ye}from"./default-config-VowXvzta.n-ThOmO1.js";import{aH as Ge}from"./kliep-tools.es.JsF2Z8dW.js";import{z as ue}from"./index.216RQMss.js";import"./index.hFbe6HFW.js";var Ze=/\s/;function Xe(l){for(var r=l.length;r--&&Ze.test(l.charAt(r)););return r}var el=/^\s+/;function ll(l){return l&&l.slice(0,Xe(l)+1).replace(el,"")}var de=NaN,tl=/^[-+]0x[0-9a-f]+$/i,al=/^0b[01]+$/i,nl=/^0o[0-7]+$/i,ol=parseInt;function il(l){if(typeof l=="number")return l;if(Ye(l))return de;if(Q(l)){var r=typeof l.valueOf=="function"?l.valueOf():l;l=Q(r)?r+"":r}if(typeof l!="string")return l===0?l:+l;l=ll(l);var d=al.test(l);return d||nl.test(l)?ol(l.slice(2),d?2:8):tl.test(l)?de:+l}var se=1/0,rl=17976931348623157e292;function W(l){if(!l)return l===0?l:0;if(l=il(l),l===se||l===-se){var r=l<0?-1:1;return r*rl}return l===l?l:0}function ul(l,r,d){if(!Q(d))return!1;var p=typeof r;return(p=="number"?Qe(d)&&Ve(r,d.length):p=="string"&&r in d)?Je(d[r],l):!1}function dl(l){return l===null}function pe(l){return l===void 0}var sl=Math.ceil,pl=Math.max;function bl(l,r,d,p){for(var C=-1,S=pl(sl((r-l)/(d||1)),0),y=Array(S);S--;)y[p?S:++C]=l,l+=d;return y}function cl(l){return function(r,d,p){return p&&typeof p!="number"&&ul(r,d,p)&&(d=p=void 0),r=W(r),d===void 0?(d=r,r=0):d=W(d),p=p===void 0?r<d?1:-1:W(p),bl(r,d,p,l)}}var vl=cl();const fl=vl,gl=Object.prototype.hasOwnProperty,be=(l,r)=>gl.call(l,r),ce=l=>l!==null&&typeof l=="object",ve="__epPropKey",ml=l=>ce(l)&&!!l[ve],yl=(l,r)=>{if(!ce(l)||ml(l))return l;const{values:d,required:p,default:C,type:S,validator:y}=l,P={type:S,required:!!p,validator:d||y?A=>{let w=!1,v=[];if(d&&(v=Array.from(d),be(l,"default")&&v.push(C),w||(w=v.includes(A))),y&&(w||(w=y(A))),!w&&v.length>0){const n=[...new Set(v)].map(o=>JSON.stringify(o)).join(", ");xe(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${n}], got value ${JSON.stringify(A)}.`)}return w}:void 0,[ve]:!0};return be(l,"default")&&(P.default=C),P},hl=["","default","small","large"],Sl=yl({type:String,values:hl,required:!1});var wl={data:{type:Array,default:()=>[]},size:Sl,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean,showOverflowTooltip:[Boolean,Object]};const Cl={class:"table mt10 mb10"},$l={class:"table-main"},xl={class:"table-main-header__slot"},Tl={key:0,class:"table-main-header__tools ml12"},Al=Te({name:"kd-table",__name:"Table",props:{...wl,height:{type:String,default:"100%"},rowKey:{type:String,default:"id"},emptyText:{type:String,default:"暂无数据"},tableFrontend:{type:Boolean,default:!1},tableAutoRowIndexSort:{type:Boolean,default:!0},tableEnableTools:{type:Boolean},tableSelectionNoAll:{type:Boolean,default:!1},tableDataRenderAgain:{type:Boolean,default:!1},tableData:{type:Array,default:()=>[]},tableColumns:{type:Array,default:()=>null},tableRequestMethod:Function,tableFilterMethod:Function,tablePagination:{type:Object},tableKey:{type:String,default:""},tableStyle:String,tableAlignWhole:{type:String},tableHeaderAlign:{type:String},tableShowOverflowTooltip:{type:Boolean},tableCommonColumnsIndex:{type:Number},tableInitQuery:{type:Object,default:()=>{}}},emits:["tableDataLoaded","tableDataRefreshed","tableDataRenderAgain","tableBeforeMount","tableMounted","tableUnmouted"],setup(l,{expose:r,emit:d}){var p,C,S,y,P,A;const w=je(()=>Ee(()=>import("./ToolsBar-xc5TLQMc.5gxkNA3c.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),v=Ge({},Ue,Ae("kd-filter-table",()=>{})),n=l,o={...v.Pagination,paginationPosition:"",paginationhidden:!1,paginationMt:10,paginationMb:!1,background:!0,small:!0,layout:"total, sizes, prev, pager, next, jumper",...n.tablePagination},B=E(!1),_=E(n.tableData?[...n.tableData.slice(0,o.paginationPageSize)]:[]),h=Oe([]),k=E(),V=(e,t)=>{We(e)&&e.map(a=>{var s,u;((s=a==null?void 0:a.type)==null?void 0:s.name)=="ElTableColumn"&&t.push(a),(u=a==null?void 0:a.children)!=null&&u.length&&V(a==null?void 0:a.children,t)})},K=n.tableColumns;if(K)h.value=n.tableColumns;else{const e=[];V(L().tableColumns(),e),h.value=e}K&&ee(()=>n.tableColumns,e=>h.value=e);const m=Pe({[o.paginationCurrentPageKey]:o.paginationCurrentPage,[o.paginationPageSizeKey]:o.paginationPageSize,[o.paginationTotalKey]:((p=n.tableData)==null?void 0:p.length)||0});Be(()=>{$("tableBeforeMount"),oe.on("filterSendQuery2Table",me)}),Ke(()=>$("tableMounted")),Re(()=>{$("tableUnmouted"),oe.off("filterSendQuery2Table")});const N=e=>{var t,a,s;return`${(e==null?void 0:e.label)||((t=e==null?void 0:e.props)==null?void 0:t.label)}_${(e==null?void 0:e.prop)||(e==null?void 0:e.property)||((a=e==null?void 0:e.props)==null?void 0:a.prop)||((s=e==null?void 0:e.props)==null?void 0:s.property)}`},{minWidthConfig:O}=v.Table,J={};O!=null&&O.length&&((C=fl(O[0],O[1]))==null||C.reduce((e,t)=>(J[t.toString()]=e,e+O[3]),O[2]));const fe=e=>{var t,a,s,u,b,c,i,f,g,X;const{showOverflowTooltip:we,align:Ce,headerAlign:$e}=v.TableColumn;return{showOverflowTooltip:pe(((t=e==null?void 0:e.props)==null?void 0:t.showOverflowTooltip)??((a=e==null?void 0:e.props)==null?void 0:a["show-overflow-tooltip"])??(e==null?void 0:e.showOverflowTooltip))?n.tableShowOverflowTooltip||we:((s=e==null?void 0:e.props)==null?void 0:s.showOverflowTooltip)??((u=e==null?void 0:e.props)==null?void 0:u["show-overflow-tooltip"])??(e==null?void 0:e.showOverflowTooltip),align:((b=e==null?void 0:e.props)==null?void 0:b.align)||(e==null?void 0:e.align)||n.tableAlignWhole||Ce,headerAlign:((c=e==null?void 0:e.props)==null?void 0:c.headerAlign)||((i=e==null?void 0:e.props)==null?void 0:i["header-align"])||(e==null?void 0:e.headerAlign)||n.tableHeaderAlign||$e,minWidth:((f=e==null?void 0:e.props)==null?void 0:f.minWidth)||((g=e==null?void 0:e.props)==null?void 0:g["min-width"])||(e==null?void 0:e.minWidth)||J[(((X=e==null?void 0:e.props)==null?void 0:X.label)||(e==null?void 0:e.label)||"").length]}},Y=(e,t,a)=>U(ue,{...t,key:N(e),...fe(e)},{...a}),z=e=>e.map(t=>{const{slot:a,headerSlot:s,cellRenderer:u,headerRenderer:b,children:c,...i}=t;let f={};return(a||s)&&(a&&(f.default=g=>D(L(),`tableColumn${re((i==null?void 0:i.prop)||(i==null?void 0:i.property))}`,{row:g.row,column:g.column,$index:g.$index})),s&&(f.header=g=>D(L(),`tableColumnHeader${re((i==null?void 0:i.prop)||(i==null?void 0:i.property))}`,{column:g.column,$index:g.$index}))),(u&&ie(u)||b&&ie(b))&&(u&&(f.default=g=>u(U,g)),b&&(f.header=g=>b(U,g))),c!=null&&c.length&&(f.default=()=>z(c)),Y(t,i,f)}),ge=e=>{const t=e==null?void 0:e.filter(a=>!(a!=null&&a.hide));return K?z(t):t.map(a=>{const{props:s,children:u}=a;let b={};return u!=null&&u.default&&(b.default=c=>u==null?void 0:u.default({row:c.row,column:c.column,$index:c.$index})),u!=null&&u.header&&(b.header=c=>u==null?void 0:u.header({column:c.column,$index:c.$index})),Y(a,s,b)})};if(!(dl(n.tableCommonColumnsIndex)||pe(n.tableCommonColumnsIndex))&&((y=(S=v.Table)==null?void 0:S.commonColumns)!=null&&y.length))if(K)h.value.splice(n.tableCommonColumnsIndex,0,...(P=v.Table)==null?void 0:P.commonColumns);else{const e=(A=v.Table)==null?void 0:A.commonColumns;h.value.splice(n.tableCommonColumnsIndex,0,...z(e))}const me=e=>k.value={...e},G=async(e="normal")=>{B.value=!0;let t={[o.paginationCurrentPageKey]:m[o.paginationCurrentPageKey],[o.paginationPageSizeKey]:m[o.paginationPageSizeKey]};e=="normal"&&(t={...t,...n.tableInitQuery,...k.value});try{const{tableList:a=[],total:s=0}=await(n.tableRequestMethod&&n.tableRequestMethod({...t}))??{tableList:[],total:0};n.tableDataRenderAgain?$("tableDataRenderAgain",{tableList:a,total:s},(u=[],b=0)=>R(u,b)):R(a,s)}finally{B.value=!1}},ye=async(e,t,a,s)=>{B.value=!0;try{let u=a;n.tableFilterMethod&&(u=n.tableFilterMethod(a,s));const b=(u==null?void 0:u.length)||0,c=o.paginationhidden?u==null?void 0:u.slice(0):(u==null?void 0:u.slice((e-1)*t,e*t))||[];n.tableDataRenderAgain?$("tableDataRenderAgain",{tableList:c,total:b},(i=[],f=0)=>R(i,f)):R(c,b)}finally{B.value=!1}},R=async(e,t=0)=>{_.value=e,m[o.paginationTotalKey]=t,await Le(),$("tableDataLoaded",e)},he=e=>{h.value=e.map(t=>{var a;return{...(a=h.value.filter(s=>N(s)==(t==null?void 0:t.key)))==null?void 0:a[0],hide:t==null?void 0:t.hide}}).slice(0)},Se=async(e="backend")=>{e=="backend"&&G(),e=="frontend"&&$("tableDataRefreshed",_.value)},$=d,Z=He();r({tableRef:()=>{var e;return(e=Z==null?void 0:Z.proxy)==null?void 0:e.$refs[`tableRef${n.tableKey}`]},doRefresh:Se});let I,j;return n.tableFrontend?j=ee([()=>m[o.paginationCurrentPageKey],()=>m[o.paginationPageSizeKey],()=>n.tableData,k],([e,t,a,s])=>{ye(e,t,a,s)},{deep:!0}):I=Fe(async()=>{G()},{flush:"post"}),n.tableFrontend&&I&&I(),!n.tableFrontend&&j&&j(),(e,t)=>{var a,s;const u=le("el-table"),b=le("el-pagination"),c=Me("loading");return x(),F("div",Cl,[M("div",$l,[M("div",{class:te(["table-main-header",e.$slots.tableHeader||n.tableEnableTools||T(v).toolsBar?"mb5":""])},[M("div",xl,[D(e.$slots,"tableHeader",{},void 0,!0)]),n.tableEnableTools||T(v).toolsBar?(x(),F("div",Tl,[ae(T(w),{"bar-setting-check-list":h.value.map(i=>{var f,g;return{label:`${(i==null?void 0:i.label)||((f=i==null?void 0:i.props)==null?void 0:f.label)}`,fixed:(i==null?void 0:i.fixed)||((g=i==null?void 0:i.props)==null?void 0:g.fixed),key:N(i)}}),onDynamicListUpdate:he},null,8,["bar-setting-check-list"])])):H("",!0)],2),De((x(),q(u,ne({ref:`tableRef${n.tableKey}`},{...n,...e.$attrs,...T(v).Table},{style:n.tableStyle||((a=T(v).Table)==null?void 0:a.style),class:n.tableSelectionNoAll?"table-selection__no--all":"",data:_.value}),{default:_e(()=>[n.tableAutoRowIndexSort?(x(),q(T(ue),{key:0,label:"序号",type:"index",width:"60",align:"center",index:i=>(m[o.paginationCurrentPageKey]-1)*m[o.paginationPageSizeKey]+i+1},null,8,["index"])):H("",!0),(x(!0),F(ke,null,ze(ge(h.value),(i,f)=>(x(),q(Ne(i),{key:`${String(i.key)}_${f}`}))),128))]),_:1},16,["style","class","data"])),[[c,B.value]]),D(e.$slots,"tableFooter",{},void 0,!0),o.paginationhidden?H("",!0):(x(),F("div",{key:0,style:Ie(`text-align: ${o.paginationPosition||((s=T(v).Pagination)==null?void 0:s.paginationAlign)};${o.paginationStyle}`),class:te(["table-main-pagination",o.paginationMt?`mt${o.paginationMt}`:"",o.paginationMb?`mb${o.paginationMb}`:"",o.paginationClass?o.paginationClass:""])},[M("span",null,[ae(b,ne({...o,...e.$attrs},{"current-page":m[o.paginationCurrentPageKey],"onUpdate:currentPage":t[0]||(t[0]=i=>m[o.paginationCurrentPageKey]=i),"page-size":m[o.paginationPageSizeKey],"onUpdate:pageSize":t[1]||(t[1]=i=>m[o.paginationPageSizeKey]=i),total:m[o.paginationTotalKey]}),null,16,["current-page","page-size","total"])])],6))])])}}}),Ml=qe(Al,[["__scopeId","data-v-686bd483"]]);export{Ml as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-xc5TLQMc.5gxkNA3c.js","assets/chunks/kliep-tools.es.JsF2Z8dW.js","assets/chunks/framework.3pdiJKKl.js","assets/chunks/index.hFbe6HFW.js","assets/chunks/index-7YPWcIce.eAhqdqSk.js","assets/chunks/isBoolean-aUzDNXxj.58RoOwsg.js","assets/chunks/default-config-VowXvzta.n-ThOmO1.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
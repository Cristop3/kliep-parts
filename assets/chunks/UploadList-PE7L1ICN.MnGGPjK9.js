import{aU as W,aV as Z}from"./kliep-tools.es.ZPSom0iB.js";import{aA as ee,aF as ae,aC as oe}from"./index-61q_dLE3.dP6FLEby.js";import{d as le,N as ne,al as se,h as te,g as p,V as re,y as v,D as n,o as s,c as g,I as t,w as r,m as a,t as w,a as de,r as V,b as S,e as F,M as ie,F as pe,E as ue,k as f}from"./framework.fC-vvecU.js";import"./index.zqm2yNl1.js";const ce={class:"upload-list"},ge=["onClick"],fe={class:"file-right"},me=le({__name:"UploadList",props:{limitSize:{default:200},screenFullLoading:{type:Boolean,default:!1},loadingType:{default:"progress"},btnLabel:{default:"选择文件"},showDownload:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},link:{type:Boolean},breforeUploadParams:{},onSuccessCb:{},onErrorCb:{},onProgressCb:{},onChangeCb:{},onBeforeUploadCb:{},modelValueString:{},modelValueFiles:{},uploadByBackend:{type:Boolean}},emits:["update:modelValueString","update:modelValueFiles","fileChange"],setup(_,{emit:L}){const e=_,D=ne("kd-upload",()=>{}),{ossUploadBackend:m={},normal:U={},ossUploadFrontend:k={}}=D,{accept:B,data:$={}}=se(),u=te(),C=p(()=>e.loadingType==="loading"),P=p(()=>e.link?"上传":e.btnLabel),z=p(()=>e.uploadByBackend?m.uploadUrl:A.value),N=p(()=>e.uploadByBackend?$:E.value),x=o=>{const c=[...i.value];c.splice(o,1),i.value=c},d=L,{ossBackData:E,ossBackAction:A,events:R}=W(e,k,u),{uploading:y,fileList:i,nativeFileList:T,uploadProgress:I,onSuccess:X,onError:j,onProgress:q,onChange:M,onBeforeUpload:Y,funcDownloadFile:G,funcUpload2String:H}=Z({uploadByBackend:e.uploadByBackend,accept:B||"*",limitSize:e.limitSize,screenFullLoading:e.screenFullLoading,modelValueString:re(()=>e.modelValueString),onProgressCb:e.onProgressCb,onChangeCb:e.onChangeCb,uploadRef:u,...R,...U,...m});return v(i,o=>{d("update:modelValueString",H(o)),d("fileChange")}),v(T,o=>{d("update:modelValueFiles",o),d("fileChange")}),(o,c)=>{const h=n("el-button"),J=n("el-progress"),K=n("el-upload"),O=n("el-icon"),Q=n("el-tooltip");return s(),g("div",ce,[t(K,ie({ref_key:"uploadListRef",ref:u,multiple:"",accept:a(B),action:z.value,"show-file-list":!1,"on-success":a(X),"on-error":a(j),"on-progress":a(q),"on-change":a(M),"before-upload":a(Y)},{...o.$attrs},{data:N.value}),{default:r(()=>[V(o.$slots,"default",{},()=>[t(h,{type:"primary",link:e.link,loading:C.value?a(y):!1},{default:r(()=>[de(w(P.value),1)]),_:1},8,["link","loading"])],!0)]),tip:r(()=>[V(o.$slots,"tip",{},void 0,!0),!C.value&&a(y)?(s(),S(J,{key:0,percentage:a(I),"stroke-width":4,striped:"","striped-flow":"",duration:10},null,8,["percentage"])):F("",!0)]),_:3},16,["accept","action","on-success","on-error","on-progress","on-change","before-upload","data"]),(s(!0),g(pe,null,ue(a(i),(l,b)=>(s(),g("div",{class:"upload-list--file mt10",key:`${l.url}_${b}`},[f("div",{class:"file-left",onClick:()=>e.showDownload&&(e.uploadByBackend?a(G)(l):a(k).onDownload(l))},[t(O,{style:{"margin-right":"6px"},size:16},{default:r(()=>[t(a(ae))]),_:1}),f("span",null,w(l==null?void 0:l.name),1)],8,ge),f("div",fe,[l!=null&&l.url&&o.$props.showDelete?(s(),S(Q,{key:0,content:`删除【${l==null?void 0:l.name}】`,placement:"top-end"},{default:r(()=>[t(h,{icon:a(oe),circle:"",type:"danger",size:"small",onClick:ke=>x(b)},null,8,["icon","onClick"])]),_:2},1032,["content"])):F("",!0)])]))),128))])}}}),be=ee(me,[["__scopeId","data-v-ee4f415a"]]);export{be as default};

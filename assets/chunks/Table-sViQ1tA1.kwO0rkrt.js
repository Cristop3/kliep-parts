import{a$ as xe,d as $e,N as Oe,h as E,G as Te,a0 as L,y as Z,a3 as Pe,ah as Ae,j as Be,A as Me,z as Ke,D as ee,aG as Re,o as $,c as R,k as F,n as le,m as O,r as k,I as te,e as H,aj as Fe,b as U,w as ke,F as De,J as _e,E as Ne,M as ae,O as je,aL as ze,aM as Ie,ay as q,P as Ee,ab as Le}from"./framework.URa763XA.js";import{U as He,D as ne,E as oe}from"../app.jvF5GiqA.js";import{E as Ue,J as qe,B as ie,x as re,V,k as Qe,v as Ve,M as We,L as Je}from"./default-config-j02UPaTJ.5ZvBw-hn.js";import{aQ as Ge}from"./kliep-tools.es.b9z_Dmbz.js";import"./theme.cz4nT2hu.js";import"./index.UfSCTmkv.js";var Ye=/\s/;function Xe(l){for(var r=l.length;r--&&Ye.test(l.charAt(r)););return r}var Ze=/^\s+/;function el(l){return l&&l.slice(0,Xe(l)+1).replace(Ze,"")}var ue=NaN,ll=/^[-+]0x[0-9a-f]+$/i,tl=/^0b[01]+$/i,al=/^0o[0-7]+$/i,nl=parseInt;function ol(l){if(typeof l=="number")return l;if(Je(l))return ue;if(V(l)){var r=typeof l.valueOf=="function"?l.valueOf():l;l=V(r)?r+"":r}if(typeof l!="string")return l===0?l:+l;l=el(l);var d=tl.test(l);return d||al.test(l)?nl(l.slice(2),d?2:8):ll.test(l)?ue:+l}var de=1/0,il=17976931348623157e292;function Q(l){if(!l)return l===0?l:0;if(l=ol(l),l===de||l===-de){var r=l<0?-1:1;return r*il}return l===l?l:0}function rl(l,r,d){if(!V(d))return!1;var p=typeof r;return(p=="number"?Qe(d)&&Ve(r,d.length):p=="string"&&r in d)?We(d[r],l):!1}function ul(l){return l===null}function se(l){return l===void 0}var dl=Math.ceil,sl=Math.max;function pl(l,r,d,p){for(var C=-1,S=sl(dl((r-l)/(d||1)),0),m=Array(S);S--;)m[p?S:++C]=l,l+=d;return m}function bl(l){return function(r,d,p){return p&&typeof p!="number"&&rl(r,d,p)&&(d=p=void 0),r=Q(r),d===void 0?(d=r,r=0):d=Q(d),p=p===void 0?r<d?1:-1:Q(p),pl(r,d,p,l)}}var cl=bl();const vl=cl,fl=Object.prototype.hasOwnProperty,pe=(l,r)=>fl.call(l,r),be=l=>l!==null&&typeof l=="object",ce="__epPropKey",gl=l=>be(l)&&!!l[ce],yl=(l,r)=>{if(!be(l)||gl(l))return l;const{values:d,required:p,default:C,type:S,validator:m}=l,A={type:S,required:!!p,validator:d||m?T=>{let w=!1,v=[];if(d&&(v=Array.from(d),pe(l,"default")&&v.push(C),w||(w=v.includes(T))),m&&(w||(w=m(T))),!w&&v.length>0){const n=[...new Set(v)].map(o=>JSON.stringify(o)).join(", ");xe(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${n}], got value ${JSON.stringify(T)}.`)}return w}:void 0,[ce]:!0};return pe(l,"default")&&(A.default=C),A},ml=["","default","small","large"],hl=yl({type:String,values:ml,required:!1});var Sl={data:{type:Array,default:()=>[]},size:hl,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean,showOverflowTooltip:[Boolean,Object]};const wl={class:"table mt10 mb10"},Cl={class:"table-main"},xl={class:"table-main-header__slot"},$l={key:0,class:"table-main-header__tools ml12"},Ol=$e({name:"kd-table",__name:"Table",props:{...Sl,height:{type:String,default:"100%"},rowKey:{type:String,default:"id"},emptyText:{type:String,default:"暂无数据"},tableFrontend:{type:Boolean,default:!1},tableAutoRowIndexSort:{type:Boolean,default:!0},tableEnableTools:{type:Boolean},tableSelectionNoAll:{type:Boolean,default:!1},tableDataRenderAgain:{type:Boolean,default:!1},tableData:{type:Array,default:()=>[]},tableColumns:{type:Array,default:()=>null},tableRequestMethod:Function,tableFilterMethod:Function,tablePagination:{type:Object},tableKey:{type:String,default:""},tableStyle:String,tableAlignWhole:{type:String},tableHeaderAlign:{type:String},tableShowOverflowTooltip:{type:Boolean},tableCommonColumnsIndex:{type:Number},tableInitQuery:{type:Object,default:()=>{}}},emits:["tableDataLoaded","tableDataRefreshed","tableDataRenderAgain","tableBeforeMount","tableMounted","tableUnmouted"],setup(l,{expose:r,emit:d}){var p,C,S,m,A,T;const w=ze(()=>Ie(()=>import("./ToolsBar-6f9pS7-u.shzCeCK4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),v=Ge({},Ue,Oe("kd-filter-table",()=>{})),n=l,o={...v.Pagination,paginationPosition:"",paginationhidden:!1,paginationMt:10,paginationMb:!1,background:!0,small:!0,layout:"total, sizes, prev, pager, next, jumper",...n.tablePagination},B=E(!1),D=E(n.tableData?[...n.tableData.slice(0,o.paginationPageSize)]:[]),h=Te([]),_=E(),W=(e,t)=>{qe(e)&&e.map(a=>{var s,u;((s=a==null?void 0:a.type)==null?void 0:s.name)=="ElTableColumn"&&t.push(a),(u=a==null?void 0:a.children)!=null&&u.length&&W(a==null?void 0:a.children,t)})},M=n.tableColumns;if(M)h.value=n.tableColumns;else{const e=[];W(L().tableColumns(),e),h.value=e}M&&Z(()=>n.tableColumns,e=>h.value=e);const y=Pe({[o.paginationCurrentPageKey]:o.paginationCurrentPage,[o.paginationPageSizeKey]:o.paginationPageSize,[o.paginationTotalKey]:((p=n.tableData)==null?void 0:p.length)||0});Ae(()=>{x("tableBeforeMount"),ne.on("filterSendQuery2Table",ge)}),Be(()=>x("tableMounted")),Me(()=>{x("tableUnmouted"),ne.off("filterSendQuery2Table")});const N=e=>{var t,a,s;return`${(e==null?void 0:e.label)||((t=e==null?void 0:e.props)==null?void 0:t.label)}_${(e==null?void 0:e.prop)||(e==null?void 0:e.property)||((a=e==null?void 0:e.props)==null?void 0:a.prop)||((s=e==null?void 0:e.props)==null?void 0:s.property)}`},{minWidthConfig:P}=v.Table,J={};P!=null&&P.length&&((C=vl(P[0],P[1]))==null||C.reduce((e,t)=>(J[t.toString()]=e,e+P[3]),P[2]));const ve=e=>{var t,a,s,u,b,c,i,f,g;const{showOverflowTooltip:Se,align:we,headerAlign:Ce}=v.TableColumn;return{showOverflowTooltip:se(((t=e==null?void 0:e.props)==null?void 0:t.showOverflowTooltip)??((a=e==null?void 0:e.props)==null?void 0:a["show-overflow-tooltip"])??(e==null?void 0:e.showOverflowTooltip))?n.tableShowOverflowTooltip||Se:((s=e==null?void 0:e.props)==null?void 0:s.showOverflowTooltip)??(e==null?void 0:e.showOverflowTooltip),align:((u=e==null?void 0:e.props)==null?void 0:u.align)||(e==null?void 0:e.align)||n.tableAlignWhole||we,headerAlign:((b=e==null?void 0:e.props)==null?void 0:b.headerAlign)||((c=e==null?void 0:e.props)==null?void 0:c["header-align"])||(e==null?void 0:e.headerAlign)||n.tableHeaderAlign||Ce,minWidth:((i=e==null?void 0:e.props)==null?void 0:i.minWidth)||((f=e==null?void 0:e.props)==null?void 0:f["min-width"])||(e==null?void 0:e.minWidth)||J[(((g=e==null?void 0:e.props)==null?void 0:g.label)||(e==null?void 0:e.label)||"").length]}},G=(e,t,a)=>q(oe,{...t,key:N(e),...ve(e)},{...a}),j=e=>e.map(t=>{const{slot:a,headerSlot:s,cellRenderer:u,headerRenderer:b,children:c,...i}=t;let f={};return(a||s)&&(a&&(f.default=g=>k(L(),`tableColumn${re((i==null?void 0:i.prop)||(i==null?void 0:i.property))}`,{row:g.row,column:g.column,$index:g.$index})),s&&(f.header=g=>k(L(),`tableColumnHeader${re((i==null?void 0:i.prop)||(i==null?void 0:i.property))}`,{column:g.column,$index:g.$index}))),(u&&ie(u)||b&&ie(b))&&(u&&(f.default=g=>u(q,g)),b&&(f.header=g=>b(q,g))),c!=null&&c.length&&(f.default=()=>j(c)),G(t,i,f)}),fe=e=>{const t=e==null?void 0:e.filter(a=>!(a!=null&&a.hide));return M?j(t):t.map(a=>{const{props:s,children:u}=a;let b={};return u!=null&&u.default&&(b.default=c=>u==null?void 0:u.default({row:c.row,column:c.column,$index:c.$index})),u!=null&&u.header&&(b.header=c=>u==null?void 0:u.header({column:c.column,$index:c.$index})),G(a,s,b)})};if(!(ul(n.tableCommonColumnsIndex)||se(n.tableCommonColumnsIndex))&&((m=(S=v.Table)==null?void 0:S.commonColumns)!=null&&m.length))if(M)h.value.splice(n.tableCommonColumnsIndex,0,...(A=v.Table)==null?void 0:A.commonColumns);else{const e=(T=v.Table)==null?void 0:T.commonColumns;h.value.splice(n.tableCommonColumnsIndex,0,...j(e))}const ge=e=>_.value={...e},Y=async(e="normal")=>{B.value=!0;let t={[o.paginationCurrentPageKey]:y[o.paginationCurrentPageKey],[o.paginationPageSizeKey]:y[o.paginationPageSizeKey]};e=="normal"&&(t={...t,...n.tableInitQuery,..._.value});try{const{tableList:a=[],total:s=0}=await(n.tableRequestMethod&&n.tableRequestMethod({...t}));n.tableDataRenderAgain?x("tableDataRenderAgain",{tableList:a,total:s},(u=[],b=0)=>K(u,b)):K(a,s)}finally{B.value=!1}},ye=async(e,t,a,s)=>{B.value=!0;try{let u=a;n.tableFilterMethod&&(u=n.tableFilterMethod(a,s));const b=(u==null?void 0:u.length)||0,c=o.paginationhidden?u==null?void 0:u.slice(0):(u==null?void 0:u.slice((e-1)*t,e*t))||[];n.tableDataRenderAgain?x("tableDataRenderAgain",{tableList:c,total:b},(i=[],f=0)=>K(i,f)):K(c,b)}finally{B.value=!1}},K=async(e,t=0)=>{D.value=e,y[o.paginationTotalKey]=t,await Ee(),x("tableDataLoaded",e)},me=e=>{h.value=e.map(t=>{var a;return{...(a=h.value.filter(s=>N(s)==(t==null?void 0:t.key)))==null?void 0:a[0],hide:t==null?void 0:t.hide}}).slice(0)},he=async(e="backend")=>{e=="backend"&&Y(),e=="frontend"&&x("tableDataRefreshed",D.value)},x=d,X=Le();r({tableRef:()=>{var e;return(e=X==null?void 0:X.proxy)==null?void 0:e.$refs[`tableRef${n.tableKey}`]},doRefresh:he});let z,I;return n.tableFrontend?I=Z([()=>y[o.paginationCurrentPageKey],()=>y[o.paginationPageSizeKey],()=>n.tableData,_],([e,t,a,s])=>{ye(e,t,a,s)},{deep:!0}):z=Ke(async()=>{Y()},{flush:"post"}),n.tableFrontend&&z&&z(),!n.tableFrontend&&I&&I(),(e,t)=>{var a,s;const u=ee("el-table"),b=ee("el-pagination"),c=Re("loading");return $(),R("div",wl,[F("div",Cl,[F("div",{class:le(["table-main-header",e.$slots.tableHeader||n.tableEnableTools||O(v).toolsBar?"mb5":""])},[F("div",xl,[k(e.$slots,"tableHeader",{},void 0,!0)]),n.tableEnableTools||O(v).toolsBar?($(),R("div",$l,[te(O(w),{"bar-setting-check-list":h.value.map(i=>{var f,g;return{label:`${(i==null?void 0:i.label)||((f=i==null?void 0:i.props)==null?void 0:f.label)}`,fixed:(i==null?void 0:i.fixed)||((g=i==null?void 0:i.props)==null?void 0:g.fixed),key:N(i)}}),onDynamicListUpdate:me},null,8,["bar-setting-check-list"])])):H("",!0)],2),Fe(($(),U(u,ae({ref:`tableRef${n.tableKey}`},{...n,...e.$attrs,...O(v).Table},{style:n.tableStyle||((a=O(v).Table)==null?void 0:a.style),class:n.tableSelectionNoAll?"table-selection__no--all":"",data:D.value}),{default:ke(()=>[n.tableAutoRowIndexSort?($(),U(O(oe),{key:0,label:"序号",type:"index",width:"60",align:"center",index:i=>(y[o.paginationCurrentPageKey]-1)*y[o.paginationPageSizeKey]+i+1},null,8,["index"])):H("",!0),($(!0),R(De,null,Ne(fe(h.value),(i,f)=>($(),U(_e(i),{key:`${String(i.key)}_${f}`}))),128))]),_:1},16,["style","class","data"])),[[c,B.value]]),k(e.$slots,"tableFooter",{},void 0,!0),o.paginationhidden?H("",!0):($(),R("div",{key:0,style:je(`text-align: ${o.paginationPosition||((s=O(v).Pagination)==null?void 0:s.paginationAlign)};${o.paginationStyle}`),class:le(["table-main-pagination",o.paginationMt?`mt${o.paginationMt}`:"",o.paginationMb?`mb${o.paginationMb}`:"",o.paginationClass?o.paginationClass:""])},[F("span",null,[te(b,ae({...o,...e.$attrs},{"current-page":y[o.paginationCurrentPageKey],"onUpdate:currentPage":t[0]||(t[0]=i=>y[o.paginationCurrentPageKey]=i),"page-size":y[o.paginationPageSizeKey],"onUpdate:pageSize":t[1]||(t[1]=i=>y[o.paginationPageSizeKey]=i),total:y[o.paginationTotalKey]}),null,16,["current-page","page-size","total"])])],6))])])}}}),Rl=He(Ol,[["__scopeId","data-v-fe63a990"]]);export{Rl as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-6f9pS7-u.shzCeCK4.js","assets/chunks/kliep-tools.es.b9z_Dmbz.js","assets/chunks/framework.URa763XA.js","assets/chunks/index.UfSCTmkv.js","assets/app.jvF5GiqA.js","assets/chunks/theme.cz4nT2hu.js","assets/chunks/isBoolean-AcbPwlS2.eQ5SRrWp.js","assets/chunks/default-config-j02UPaTJ.5ZvBw-hn.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
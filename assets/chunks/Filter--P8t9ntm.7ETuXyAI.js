import{d as ie,N as ue,h as T,g as S,y as se,aW as de,j as me,A as fe,D as m,o as u,c as K,r as U,k as P,I as _,w as p,m as b,F as L,e as v,M as F,Z as ce,b as I,E as j,a as A,O as pe,a5 as ve,a6 as ye}from"./framework.3pdiJKKl.js";import{aH as be,x as Ie,aD as z,aI as O,E as ge,M as he}from"./kliep-tools.es.JsF2Z8dW.js";import{$ as ke,a0 as Ce,a1 as Z,a2 as Ve,a3 as Ke}from"./index-7YPWcIce.eAhqdqSk.js";import{b as _e,g as Fe,c as Be,k as $e}from"./default-config-VowXvzta.n-ThOmO1.js";import{S as Te,O as Pe,a as Le,Z as Re,y as we,W as Me,z as He,n as Se}from"./isBoolean-aUzDNXxj.58RoOwsg.js";import"./index.hFbe6HFW.js";var Ue="[object Map]",Oe="[object Set]",De=Object.prototype,Ee=De.hasOwnProperty;function q(o){if(o==null)return!0;if(Be(o)&&($e(o)||typeof o=="string"||typeof o.splice=="function"||Le(o)||Re(o)||we(o)))return!o.length;var B=Me(o);if(B==Ue||B==Oe)return!o.size;if(He(o))return!Se(o).length;for(var R in o)if(Ee.call(o,R))return!1;return!0}const Ne={class:"filter"},xe={class:"filter-main__form mr10"},je={class:"filter-main__btn"},Ae={class:"filter-main__btn--align"},ze=ie({name:"kd-filter",__name:"Filter",props:{filterName:{default:""},filterList:{default:()=>[]},filterCol:{},filterFieldsColon:{type:Boolean,default:!1},filterQueryCache:{type:Boolean,default:!1},filterDefaultBtn:{type:Boolean,default:!0},filterCache:{type:Boolean,default:!0},filterEnableTools:{type:Boolean}},emits:["filterSearchCb","filterResetCb","filterBeforeMount","filterMounted","filterUnmouted"],setup(o,{expose:B,emit:R}){const W=ve(()=>ye(()=>import("./ToolsBar-xc5TLQMc.5gxkNA3c.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),G=be({},_e,ue("kd-filter-table",()=>{})),s=o,Q={...Ie[30]},X={},Y={},g=T(),D={input:"",select:"",selectMutiple:[],datePicker:""},E=S(()=>s.filterList.filter(l=>Te(l.formItemHidden)?!l.formItemHidden:!(Ce(l.formItemHidden)&&l.formItemHidden())).map(l=>(l.key=`${l.formItemLabel}_${l.formItemKey}`,l))),w=l=>{const a={};return l.reduce((r,i)=>{const{formItemKey:d,formItemType:f,disabled:C,formItemInitValue:c,datePickerReallyKeys:y}=i;if(!C&&!q(c)){if(f=="datePicker"&&y){const[V,$]=y.split(",");r[V]=c[0],r[$]=c[1]}r[d]=c}else r[d]=D[f]??"";return r},a),{...a}},h=T(Pe(E.value)),t=T(w(h.value)),J=T(!1),ee=S(()=>h.value.length>24/z.md?{alignItems:"center"}:{}),le=S(()=>s.filterCol?s.filterCol:z);se(()=>s.filterList,(l,a)=>{const r={};a==null||a.map(i=>{const{formItemKey:d,formItemType:f,disabled:C}=i;if(C&&(t.value[d]=D[f],f=="datePicker")){const{datePickerReallyKeys:c}=i,[y,V]=c.split(",");t.value[y]="",t.value[V]=""}r[d]=f}),l!=null&&l.some(i=>!r[i==null?void 0:i.formItemKey])&&(t.value=w(s.filterList)),h.value=[...l]},{deep:!0}),de(()=>{const l=O({...t.value});!q(l)&&Z.emit("filterSendInit2Table",{...l}),k("filterBeforeMount")}),me(()=>k("filterMounted")),fe(()=>k("filterUnmouted"));const te=(l="表单项")=>`${l}${s.filterFieldsColon?"：":""}`,ae=l=>[l?{...he,message:""}:{required:!1}],M=(l="表单项",a)=>{switch(a){case"input":return`请输入${l}`;case"select":return`请选择${l}`;case"datePicker":return`请选择${l}`;default:return`请输入${l}`}},oe=(l,a,r)=>{if(a){const[i,d]=[...a.split(",")];t.value[i]=(l==null?void 0:l[0])??"",t.value[d]=(l==null?void 0:l[1])??"",r.change&&r.change(l)}},N=l=>{l==null||l.resetFields(),k("filterResetCb",l),t.value=w(s.filterList),x(O({...t.value}))},H=()=>{g.value.validate(l=>{if(!l)return!1;const a=O({...t.value});k("filterSearchCb",a),x(a)})},re=l=>{var a;h.value=l,(a=l==null?void 0:l.filter(r=>r.formItemHidden))==null||a.map(r=>{const{formItemKey:i}=r;g.value.resetFields(i)})},x=l=>Z.emit("filterSendQuery2Table",l),k=R;return B({formRef:g,formValue:t,doSearch:H,doReset:N}),(l,a)=>{const r=m("el-input"),i=m("el-option"),d=m("el-select"),f=m("el-date-picker"),C=m("el-form-item"),c=m("el-col"),y=m("el-row"),V=m("el-form"),$=m("el-button");return u(),K("div",Ne,[U(l.$slots,"filterHeader",{},void 0,!0),P("div",{class:"filter-main",style:pe(ee.value)},[P("div",xe,[_(V,{ref_key:"formRef",ref:g,model:t.value},{default:p(()=>[_(y,{gutter:b(ge)[20]},{default:p(()=>[(u(!0),K(L,null,j(h.value,(e,ne)=>(u(),K(L,null,[e.formItemHidden?v("",!0):(u(),I(c,F({key:0},le.value,{key:`${e.formItemKey}_${ne}`,class:"pb5"}),{default:p(()=>[_(C,{prop:e.formItemKey,label:te(e.formItemLabel),rules:ae(!!e.formItemRequired)},{default:p(()=>[e.formItemType=="input"?(u(),I(r,F({key:0,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":n=>t.value[e.formItemKey]=n,placeholder:M(e.formItemLabel,"input")},{...Q,...e},{onKeydown:ce(H,["enter"]),onClick:e==null?void 0:e.click,onBlur:e==null?void 0:e.blur,onInput:e==null?void 0:e.input,onClear:e==null?void 0:e.clear,onChange:e==null?void 0:e.change,onFocus:e==null?void 0:e.focus}),null,16,["modelValue","onUpdate:modelValue","placeholder","onKeydown","onClick","onBlur","onInput","onClear","onChange","onFocus"])):v("",!0),e.formItemType=="select"?(u(),I(d,F({key:1,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":n=>t.value[e.formItemKey]=n,placeholder:M(e.formItemLabel,"select")},{...X,...e},{onChange:e==null?void 0:e.change,onClear:e==null?void 0:e.clear,onBlur:e==null?void 0:e.blur,onFocus:e==null?void 0:e.focus,onVisibleChange:e==null?void 0:e.visibleChange,onRemoveTag:e==null?void 0:e.removeTag,style:{width:"100%"}}),{default:p(()=>[(u(!0),K(L,null,j(e.selectOptions,n=>(u(),I(i,{key:e.selectKeyValueField?n[e.selectKeyValueField.value]:n.value,label:e.selectKeyValueField?typeof e.selectKeyValueField.label=="function"?e.selectKeyValueField.label(n):n[e.selectKeyValueField.label]:n.label,value:e.selectKeyValueField?n[e.selectKeyValueField.value]:n.value},null,8,["label","value"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear","onBlur","onFocus","onVisibleChange","onRemoveTag"])):v("",!0),e.formItemType=="datePicker"?(u(),I(f,F({key:2,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":n=>t.value[e.formItemKey]=n,placeholder:M(e.formItemLabel,"datePicker")},{...Y,...e},{onChange:n=>oe(n,e.datePickerReallyKeys,e)}),null,16,["modelValue","onUpdate:modelValue","placeholder","onChange"])):v("",!0),e.formItemType=="slot"?U(l.$slots,`filter${b(Fe)(e.formItemKey)}`,F({key:3,modelValue:{value:t.value[e.formItemKey]},updateModelValue:n=>t.value[e.formItemKey]=n},e),void 0,!0):v("",!0)]),_:2},1032,["prop","label","rules"])]),_:2},1040))],64))),256))]),_:3},8,["gutter"])]),_:3},8,["model"])]),P("div",je,[P("div",Ae,[s.filterDefaultBtn?(u(),K(L,{key:0},[_($,{type:"primary",icon:b(Ve),loading:J.value,onClick:H},{default:p(()=>[A(" 查询 ")]),_:1},8,["icon","loading"]),_($,{icon:b(Ke),onClick:a[0]||(a[0]=e=>N(g.value))},{default:p(()=>[A(" 重置 ")]),_:1},8,["icon"])],64)):v("",!0),U(l.$slots,"filterBtn",{},void 0,!0),s.filterEnableTools||b(G).toolsBar?(u(),I(b(W),{key:1,class:"ml12","bar-setting-tool-tip-content":"搜索项设置","bar-setting-popover-check-all-label":"搜索显示","bar-setting-check-label":"formItemLabel","bar-setting-hide-key":"formItemHidden","bar-setting-no-drag-key":"formItemRequired","bar-setting-check-list":E.value,onDynamicListUpdate:re},null,8,["bar-setting-check-list"])):v("",!0)])])],4)])}}}),Ye=ke(ze,[["__scopeId","data-v-c782f75b"]]);export{Ye as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-xc5TLQMc.5gxkNA3c.js","assets/chunks/kliep-tools.es.JsF2Z8dW.js","assets/chunks/framework.3pdiJKKl.js","assets/chunks/index.hFbe6HFW.js","assets/chunks/index-7YPWcIce.eAhqdqSk.js","assets/chunks/isBoolean-aUzDNXxj.58RoOwsg.js","assets/chunks/default-config-VowXvzta.n-ThOmO1.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as oe,N as re,h as B,g as U,y as ne,af as ie,j as ue,A as se,D as d,o as u,c as C,r as H,k as F,I as K,w as c,m as y,F as $,e as p,M as V,Z as me,b,E as D,a as j,O as de,aL as fe,aM as ce}from"./framework.0_9lIZ6q.js";import{aI as pe,aG as A,aJ as ve,aK as ye}from"./kliep-tools.es.tMBrXarW.js";import{P as be,o as Ie,a as he,x as ke}from"../app.AtQX56oF.js";import{J as ge,e as Ce,B as Ke,o as Ve,R as _e,O as Be,r as Fe,m as $e,W as Le,s as Re,u as Te}from"./default-config-vTBcr4uU.VFBXf3Sq.js";import{x as we,m as Me}from"./isBoolean-VOtsXdoj.1zH29Inw.js";import"./index.MjdE9xpz.js";import"./theme.SbXruKJR.js";var Pe="[object Map]",Ue="[object Set]",He=Object.prototype,Ee=He.hasOwnProperty;function xe(o){if(o==null)return!0;if(Ve(o)&&(_e(o)||typeof o=="string"||typeof o.splice=="function"||Be(o)||Fe(o)||$e(o)))return!o.length;var _=Le(o);if(_==Pe||_==Ue)return!o.size;if(Re(o))return!Te(o).length;for(var L in o)if(Ee.call(o,L))return!1;return!0}const Ne={class:"filter"},Oe={class:"filter-main__form mr10"},Se={class:"filter-main__btn"},De={class:"filter-main__btn--align"},je=oe({name:"kd-filter",__name:"Filter",props:{filterName:{default:""},filterList:{default:()=>[]},filterCol:{},filterFieldsColon:{type:Boolean,default:!1},filterQueryCache:{type:Boolean,default:!1},filterDefaultBtn:{type:Boolean,default:!0},filterCache:{type:Boolean,default:!0},filterEnableTools:{type:Boolean}},emits:["filterSearchCb","filterResetCb","filterBeforeMount","filterMounted","filterUnmouted"],setup(o,{expose:_,emit:L}){const q=fe(()=>ce(()=>import("./ToolsBar-9c54xIul.YRlzGzWx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),J=re("kd-filter-table")||{...ge},s=o,Q={...pe[30]},W={},z={},I=B(),E={input:"",select:"",selectMutiple:[],datePicker:""},x=U(()=>s.filterList.filter(l=>we(l.formItemHidden)?!l.formItemHidden:!(Ce(l.formItemHidden)&&l.formItemHidden())).map(l=>(l.key=`${l.formItemLabel}_${l.formItemKey}`,l))),R=l=>{const a={};return l.reduce((n,i)=>{const{formItemKey:m,formItemType:f,disabled:g,formItemInitValue:v}=i;return!g&&!xe(v)?n[m]=v:n[m]=E[f]??"",n},a),{...a}},h=B(Me(x.value)),t=B(R(h.value)),Z=B(!1),G=U(()=>h.value.length>24/A.md?{alignItems:"center"}:{}),X=U(()=>s.filterCol?s.filterCol:A);ne(()=>s.filterList,(l,a)=>{const n={};a==null||a.map(i=>{const{formItemKey:m,formItemType:f,disabled:g}=i;if(g&&(t.value[m]=E[f],f=="datePicker")){const{datePickerReallyKeys:v}=i,[M,P]=v.split(",");t.value[M]="",t.value[P]=""}n[m]=f}),l!=null&&l.some(i=>!n[i==null?void 0:i.formItemKey])&&(t.value=R(s.filterList)),h.value=[...l]},{deep:!0}),ie(()=>k("filterBeforeMount")),ue(()=>k("filterMounted")),se(()=>k("filterUnmouted"));const Y=(l="表单项")=>`${l}${s.filterFieldsColon?"：":""}`,ee=l=>[l?{...ye,message:""}:{required:!1}],T=(l="表单项",a)=>{switch(a){case"input":return`请输入${l}`;case"select":return`请选择${l}`;case"datePicker":return`请选择${l}`;default:return`请输入${l}`}},le=(l,a,n)=>{if(a){const[i,m]=[...a.split(",")];t.value[i]=(l==null?void 0:l[0])??"",t.value[m]=(l==null?void 0:l[1])??"",n.change&&n.change(l)}},N=l=>{l==null||l.resetFields(),k("filterResetCb",l),t.value=R(s.filterList),O(t.value)},w=()=>{I.value.validate(l=>{if(!l)return!1;const a={...t.value};k("filterSearchCb",a),O(a)})},te=l=>{var a;h.value=l,(a=l==null?void 0:l.filter(n=>n.formItemHidden))==null||a.map(n=>{const{formItemKey:i}=n;I.value.resetFields(i)})},O=l=>ke.emit("filterSendQuery2Table",l),k=L;return _({formRef:I,formValue:t,doSearch:w,doReset:N}),(l,a)=>{const n=d("el-input"),i=d("el-option"),m=d("el-select"),f=d("el-date-picker"),g=d("el-form-item"),v=d("el-col"),M=d("el-row"),P=d("el-form"),S=d("el-button");return u(),C("div",Ne,[H(l.$slots,"filterHeader",{},void 0,!0),F("div",{class:"filter-main",style:de(G.value)},[F("div",Oe,[K(P,{ref_key:"formRef",ref:I,model:t.value},{default:c(()=>[K(M,{gutter:y(ve)[20]},{default:c(()=>[(u(!0),C($,null,D(h.value,(e,ae)=>(u(),C($,null,[e.formItemHidden?p("",!0):(u(),b(v,V({key:0},X.value,{key:`${e.formItemKey}_${ae}`}),{default:c(()=>[K(g,{prop:e.formItemKey,label:Y(e.formItemLabel),rules:ee(!!e.formItemRequired)},{default:c(()=>[e.formItemType=="input"?(u(),b(n,V({key:0,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:T(e.formItemLabel,"input")},{...Q,...e},{onKeydown:me(w,["enter"]),onClick:e==null?void 0:e.click,onBlur:e==null?void 0:e.blur,onInput:e==null?void 0:e.input,onClear:e==null?void 0:e.clear,onChange:e==null?void 0:e.change,onFocus:e==null?void 0:e.focus}),null,16,["modelValue","onUpdate:modelValue","placeholder","onKeydown","onClick","onBlur","onInput","onClear","onChange","onFocus"])):p("",!0),e.formItemType=="select"?(u(),b(m,V({key:1,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:T(e.formItemLabel,"select")},{...W,...e},{onChange:e==null?void 0:e.change,onClear:e==null?void 0:e.clear,onBlur:e==null?void 0:e.blur,onFocus:e==null?void 0:e.focus,onVisibleChange:e==null?void 0:e.visibleChange,onRemoveTag:e==null?void 0:e.removeTag,style:{width:"100%"}}),{default:c(()=>[(u(!0),C($,null,D(e.selectOptions,r=>(u(),b(i,{key:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value,label:e.selectKeyValueField?typeof e.selectKeyValueField.label=="function"?e.selectKeyValueField.label(r):r[e.selectKeyValueField.label]:r.label,value:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value},null,8,["label","value"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear","onBlur","onFocus","onVisibleChange","onRemoveTag"])):p("",!0),e.formItemType=="datePicker"?(u(),b(f,V({key:2,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:T(e.formItemLabel,"datePicker")},{...z,...e},{onChange:r=>le(r,e.datePickerReallyKeys,e)}),null,16,["modelValue","onUpdate:modelValue","placeholder","onChange"])):p("",!0),e.formItemType=="slot"?H(l.$slots,`filter${y(Ke)(e.formItemKey)}`,V({key:3,modelValue:{value:t.value[e.formItemKey]},updateModelValue:r=>t.value[e.formItemKey]=r},e),void 0,!0):p("",!0)]),_:2},1032,["prop","label","rules"])]),_:2},1040))],64))),256))]),_:3},8,["gutter"])]),_:3},8,["model"])]),F("div",Se,[F("div",De,[s.filterDefaultBtn?(u(),C($,{key:0},[K(S,{type:"primary",icon:y(Ie),loading:Z.value,onClick:w},{default:c(()=>[j(" 查询 ")]),_:1},8,["icon","loading"]),K(S,{icon:y(he),onClick:a[0]||(a[0]=e=>N(I.value))},{default:c(()=>[j(" 重置 ")]),_:1},8,["icon"])],64)):p("",!0),H(l.$slots,"filterBtn",{},void 0,!0),s.filterEnableTools||y(J).toolsBar?(u(),b(y(q),{key:1,class:"ml12","bar-setting-tool-tip-content":"搜索项设置","bar-setting-popover-check-all-label":"搜索显示","bar-setting-check-label":"formItemLabel","bar-setting-hide-key":"formItemHidden","bar-setting-no-drag-key":"formItemRequired","bar-setting-check-list":x.value,onDynamicListUpdate:te},null,8,["bar-setting-check-list"])):p("",!0)])])],4)])}}}),Ge=be(je,[["__scopeId","data-v-9aa839b8"]]);export{Ge as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-9c54xIul.YRlzGzWx.js","assets/chunks/kliep-tools.es.tMBrXarW.js","assets/chunks/framework.0_9lIZ6q.js","assets/chunks/index.MjdE9xpz.js","assets/app.AtQX56oF.js","assets/chunks/theme.SbXruKJR.js","assets/chunks/isBoolean-VOtsXdoj.1zH29Inw.js","assets/chunks/default-config-vTBcr4uU.VFBXf3Sq.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as ae,h as F,g as H,y as oe,ai as re,j as ne,A as ie,D as d,o as u,c as g,r as T,k as B,I as v,w as c,m as k,F as L,e as y,M as C,Z as ue,b as V,E as N,a as q,O as se,aO as de,aP as me}from"./framework.oUV_62tH.js";import{a as fe,f as A,i as ce,c as pe}from"./kliep-tools.es.nA_SJfqh.js";import{G as ve,m as ye,v as Ie,P as he}from"../app.9Rnp9Vql.js";import{x as be,O as ge}from"./isBoolean-ACOet8D1.KxKfQU1l.js";import{e as ke,H as Ce,o as Ve,z as Ke,O as _e,r as Fe,m as Be,L as Le,s as Re,u as Pe}from"./Uint8Array-LeCd-Zzf.1MEzJDur.js";import"./theme.mz_XRuro.js";var Ue="[object Map]",Me="[object Set]",$e=Object.prototype,we=$e.hasOwnProperty;function He(o){if(o==null)return!0;if(Ve(o)&&(Ke(o)||typeof o=="string"||typeof o.splice=="function"||_e(o)||Fe(o)||Be(o)))return!o.length;var K=Le(o);if(K==Ue||K==Me)return!o.size;if(Re(o))return!Pe(o).length;for(var R in o)if(we.call(o,R))return!1;return!0}const Te={class:"filter"},Oe={class:"filter-main__form mr10"},Se={class:"filter-main__btn"},xe={class:"filter-main__btn--align"},De=ae({name:"kd-filter",__name:"Filter",props:{filterName:{default:""},filterList:{default:()=>[]},filterCol:{},filterFieldsColon:{type:Boolean,default:!1},filterQueryCache:{type:Boolean,default:!1},filterDefaultBtn:{type:Boolean,default:!0},filterCache:{type:Boolean,default:!0}},emits:["filterSearchCb","filterResetCb","filterBeforeMount","filterMounted","filterUnmouted"],setup(o,{expose:K,emit:R}){const j=de(()=>me(()=>import("./ToolsBar-Mf6A1PYU.4ygL-0Sy.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),m=o,z={...fe[30]},Q={},Z={},I=F(),O={input:"",select:"",selectMutiple:[],datePicker:""},S=H(()=>m.filterList.filter(l=>be(l.formItemHidden)?!l.formItemHidden:!(ke(l.formItemHidden)&&l.formItemHidden()))),P=l=>{const a={};return l.reduce((n,i)=>{const{formItemKey:s,formItemType:f,disabled:b,formItemInitValue:p}=i;return!b&&!He(p)?n[s]=p:n[s]=O[f]??"",n},a),{...a}},_=F(ge(S.value)),t=F(P(_.value)),G=F(!1),J=H(()=>_.value.length>24/A.md?{alignItems:"center"}:{}),W=H(()=>m.filterCol?m.filterCol:A);oe(()=>m.filterList,(l,a)=>{const n={};a==null||a.map(i=>{const{formItemKey:s,formItemType:f,disabled:b}=i;if(b&&(t.value[s]=O[f],f=="datePicker")){const{datePickerReallyKeys:p}=i,[$,w]=p.split(",");t.value[$]="",t.value[w]=""}n[s]=f}),l!=null&&l.some(i=>!n[i==null?void 0:i.formItemKey])&&(t.value=P(m.filterList))},{deep:!0}),re(()=>h("filterBeforeMount")),ne(()=>h("filterMounted")),ie(()=>h("filterUnmouted"));const X=(l="表单项")=>`${l}${m.filterFieldsColon?"：":""}`,Y=l=>[l?{...pe,message:""}:{required:!1}],U=(l="表单项",a)=>{switch(a){case"input":return`请输入${l}`;case"select":return`请选择${l}`;case"datePicker":return`请选择${l}`;default:return`请输入${l}`}},ee=(l,a,n)=>{if(a){const[i,s]=[...a.split(",")];t.value[i]=(l==null?void 0:l[0])??"",t.value[s]=(l==null?void 0:l[1])??"",n.change&&n.change(l)}},x=l=>{l==null||l.resetFields(),h("filterResetCb",l),t.value=P(m.filterList),D(t.value)},M=()=>{I.value.validate(l=>{if(!l)return!1;const a={...t.value};h("filterSearchCb",a),D(a)})},le=l=>{var a;_.value=l,(a=l==null?void 0:l.filter(n=>n.formItemHidden))==null||a.map(n=>{const{formItemKey:i}=n;I.value.resetFields(i)})},D=l=>he.emit("filterSendQuery",l),h=R;return K({formRef:I,formValue:t,doSearch:M,doReset:x}),(l,a)=>{const n=d("el-input"),i=d("el-option"),s=d("el-select"),f=d("el-date-picker"),b=d("el-form-item"),p=d("el-col"),$=d("el-row"),w=d("el-form"),E=d("el-button");return u(),g("div",Te,[T(l.$slots,"filterHeader",{},void 0,!0),B("div",{class:"filter-main",style:se(J.value)},[B("div",Oe,[v(w,{ref_key:"formRef",ref:I,model:t.value},{default:c(()=>[v($,{gutter:k(ce)[20]},{default:c(()=>[(u(!0),g(L,null,N(_.value,(e,te)=>(u(),g(L,null,[e.formItemHidden?y("",!0):(u(),V(p,C({key:0},W.value,{key:te}),{default:c(()=>[v(b,{prop:e.formItemKey,label:X(e.formItemLabel),rules:Y(!!e.formItemRequired)},{default:c(()=>[e.formItemType=="input"?(u(),V(n,C({key:0,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:U(e.formItemLabel,"input")},{...z,...e},{onKeydown:ue(M,["enter"]),onClick:e==null?void 0:e.click,onBlur:e==null?void 0:e.blur,onInput:e==null?void 0:e.input,onClear:e==null?void 0:e.clear,onChange:e==null?void 0:e.change,onFocus:e==null?void 0:e.focus}),null,16,["modelValue","onUpdate:modelValue","placeholder","onKeydown","onClick","onBlur","onInput","onClear","onChange","onFocus"])):y("",!0),e.formItemType=="select"?(u(),V(s,C({key:1,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:U(e.formItemLabel,"select")},{...Q,...e},{onChange:e==null?void 0:e.change,onClear:e==null?void 0:e.clear,onBlur:e==null?void 0:e.blur,onFocus:e==null?void 0:e.focus,onVisibleChange:e==null?void 0:e.visibleChange,onRemoveTag:e==null?void 0:e.removeTag,style:{width:"100%"}}),{default:c(()=>[(u(!0),g(L,null,N(e.selectOptions,r=>(u(),V(i,{key:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value,label:e.selectKeyValueField?typeof e.selectKeyValueField.label=="function"?e.selectKeyValueField.label(r):r[e.selectKeyValueField.label]:r.label,value:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value},null,8,["label","value"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear","onBlur","onFocus","onVisibleChange","onRemoveTag"])):y("",!0),e.formItemType=="datePicker"?(u(),V(f,C({key:2,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:U(e.formItemLabel,"datePicker")},{...Z,...e},{onChange:r=>ee(r,e.datePickerReallyKeys,e)}),null,16,["modelValue","onUpdate:modelValue","placeholder","onChange"])):y("",!0),e.formItemType=="slot"?T(l.$slots,`filter${k(Ce)(e.formItemKey)}`,C({key:3,modelValue:{value:t.value[e.formItemKey]},updateModelValue:r=>t.value[e.formItemKey]=r},e),void 0,!0):y("",!0)]),_:2},1032,["prop","label","rules"])]),_:2},1040))],64))),256))]),_:3},8,["gutter"])]),_:3},8,["model"])]),B("div",Se,[B("div",xe,[m.filterDefaultBtn?(u(),g(L,{key:0},[v(E,{type:"primary",icon:k(ye),loading:G.value,onClick:M},{default:c(()=>[q(" 查询 ")]),_:1},8,["icon","loading"]),v(E,{icon:k(Ie),onClick:a[0]||(a[0]=e=>x(I.value))},{default:c(()=>[q(" 重置 ")]),_:1},8,["icon"])],64)):y("",!0),T(l.$slots,"filterBtn",{},void 0,!0),v(k(j),{class:"ml12","bar-setting-tool-tip-content":"搜索项设置","bar-setting-popover-check-all-label":"搜索显示","bar-setting-check-key":"formItemLabel","bar-setting-hide-key":"formItemHidden","bar-setting-no-drag-key":"formItemRequired","bar-setting-check-list":S.value,onDynamicListUpdate:le},null,8,["bar-setting-check-list"])])])],4)])}}}),Qe=ve(De,[["__scopeId","data-v-60897212"]]);export{Qe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-Mf6A1PYU.4ygL-0Sy.js","assets/chunks/kliep-tools.es.nA_SJfqh.js","assets/app.9Rnp9Vql.js","assets/chunks/framework.oUV_62tH.js","assets/chunks/theme.mz_XRuro.js","assets/chunks/isBoolean-ACOet8D1.KxKfQU1l.js","assets/chunks/Uint8Array-LeCd-Zzf.1MEzJDur.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
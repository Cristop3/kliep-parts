import{aU as W,aV as Z}from"./kliep-tools.es.JjaqLF3K.js";import{aA as ee,aF as ae,aC as oe}from"./index-y7NQ2Az-.wnp4bUzv.js";import{d as le,N as ne,al as se,h as te,g as u,V as de,y as b,D as n,o as s,c as g,I as t,w as d,m as a,t as w,a as ie,r as V,b as S,e as F,M as re,F as ue,E as pe,k as f}from"./framework.fC-vvecU.js";import"./index.zqm2yNl1.js";const ce={class:"upload-list"},ge=["onClick"],fe={class:"file-right"},me=le({__name:"UploadList",props:{limitSize:{default:200},screenFullLoading:{type:Boolean,default:!1},loadingType:{default:"progress"},btnLabel:{default:"选择文件"},showDownload:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},link:{type:Boolean},onSuccessCb:{},onErrorCb:{},onProgressCb:{},onChangeCb:{},onBeforeUploadCb:{},modelValueString:{},modelValueFiles:{},uploadByBackend:{type:Boolean}},emits:["update:modelValueString","update:modelValueFiles","fileChange"],setup(_,{emit:L}){const e=_,D=ne("kd-upload",()=>{}),{ossUploadBackend:m={},normal:$={},ossUploadFrontend:k={}}=D,{accept:B,data:U={}}=se(),p=te(),C=u(()=>e.loadingType==="loading"),P=u(()=>e.link?"上传":e.btnLabel),z=u(()=>e.uploadByBackend?m.uploadUrl:A.value),N=u(()=>e.uploadByBackend?U:E.value),x=o=>{const c=[...r.value];c.splice(o,1),r.value=c},i=L,{ossBackData:E,ossBackAction:A,events:R}=W(e,k,p),{uploading:y,fileList:r,nativeFileList:T,uploadProgress:I,onSuccess:X,onError:j,onProgress:q,onChange:M,onBeforeUpload:Y,funcDownloadFile:G,funcUpload2String:H}=Z({uploadByBackend:e.uploadByBackend,accept:B||"*",limitSize:e.limitSize,screenFullLoading:e.screenFullLoading,modelValueString:de(()=>e.modelValueString),onProgressCb:e.onProgressCb,onChangeCb:e.onChangeCb,uploadRef:p,...R,...$,...m});return b(r,o=>{i("update:modelValueString",H(o)),i("fileChange")}),b(T,o=>{i("update:modelValueFiles",o),i("fileChange")}),(o,c)=>{const h=n("el-button"),J=n("el-progress"),K=n("el-upload"),O=n("el-icon"),Q=n("el-tooltip");return s(),g("div",ce,[t(K,re({ref_key:"uploadListRef",ref:p,multiple:"",accept:a(B),action:z.value,"show-file-list":!1,"on-success":a(X),"on-error":a(j),"on-progress":a(q),"on-change":a(M),"before-upload":a(Y)},{...o.$attrs},{data:N.value}),{default:d(()=>[V(o.$slots,"default",{},()=>[t(h,{type:"primary",link:e.link,loading:C.value?a(y):!1},{default:d(()=>[ie(w(P.value),1)]),_:1},8,["link","loading"])],!0)]),tip:d(()=>[V(o.$slots,"tip",{},void 0,!0),!C.value&&a(y)?(s(),S(J,{key:0,percentage:a(I),"stroke-width":4,striped:"","striped-flow":"",duration:10},null,8,["percentage"])):F("",!0)]),_:3},16,["accept","action","on-success","on-error","on-progress","on-change","before-upload","data"]),(s(!0),g(ue,null,pe(a(r),(l,v)=>(s(),g("div",{class:"upload-list--file mt10",key:`${l.url}_${v}`},[f("div",{class:"file-left",onClick:()=>e.showDownload&&(e.uploadByBackend?a(G)(l):a(k).onDownload(l))},[t(O,{style:{"margin-right":"6px"},size:16},{default:d(()=>[t(a(ae))]),_:1}),f("span",null,w(l==null?void 0:l.name),1)],8,ge),f("div",fe,[l!=null&&l.url&&o.$props.showDelete?(s(),S(Q,{key:0,content:`删除【${l==null?void 0:l.name}】`,placement:"top-end"},{default:d(()=>[t(h,{icon:a(oe),circle:"",type:"danger",size:"small",onClick:ke=>x(v)},null,8,["icon","onClick"])]),_:2},1032,["content"])):F("",!0)])]))),128))])}}}),ve=ee(me,[["__scopeId","data-v-ee4f415a"]]);export{ve as default};

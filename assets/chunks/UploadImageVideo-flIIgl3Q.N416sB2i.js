import{aU as ne,aV as de}from"./kliep-tools.es.JjaqLF3K.js";import{aA as ie,aB as re,aC as ce,aD as ue,aE as pe}from"./index-qAyI4RUB.bETfU6ur.js";import{d as ge,N as me,al as fe,h as T,a7 as ve,g as h,z as he,V as ye,y as $,D as n,az as ke,ad as Be,m as e,o,c as d,b as i,w as l,I as t,k as m,e as y,M as P,F as be,t as Ce,r as we,O as Se}from"./framework.fC-vvecU.js";import"./index.zqm2yNl1.js";const _e={class:"thumb-tools-download"},Ve={class:"image-slot"},ze=["src","type"],De={class:"upload-iv-upload__content"},Fe={key:0,class:"upload-iv-label"},Ue=ge({__name:"UploadImageVideo",props:{width:{default:"400px"},height:{default:"200px"},iconSize:{default:28},uploadType:{},limitSize:{default:50},screenFullLoading:{type:Boolean,default:!1},loadingType:{default:"progress"},btnLabel:{default:"上传图片"},showDownload:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},link:{type:Boolean},onSuccessCb:{},onErrorCb:{},onProgressCb:{},onChangeCb:{},onBeforeUploadCb:{},modelValueString:{},modelValueFiles:{},uploadByBackend:{type:Boolean}},emits:["update:modelValueString","update:modelValueFiles","fileChange"],setup(x,{emit:E}){const a=x,I=me("kd-upload",()=>{}),{ossUploadBackend:k={},normal:N={},ossUploadFrontend:B={}}=I,{accept:b=`${a.uploadType}/*`,data:R={}}=fe(),r=T(),c=T(),f=ve({width:0,height:172}),A=h(()=>a.loadingType==="loading"),j=h(()=>a.uploadByBackend?k.uploadUrl:O.value),q=h(()=>a.uploadByBackend?R:M.value);he(()=>{c.value&&(f.height=c.value.clientHeight,f.width=c.value.clientWidth)});const H=()=>{g.value=[],S.value="",r.value.handleRemove(_)},u=E,{ossBackData:M,ossBackAction:O,events:W}=ne(a,B,r),{uploading:C,name:w,url:S,streamFullUrl:p,fileList:g,nativeFileList:_,uploadProgress:X,onSuccess:Y,onError:Z,onProgress:G,onChange:J,onBeforeUpload:K,funcDownloadFile:Q,funcUpload2String:ee}=de({uploadByBackend:a.uploadByBackend,accept:b,screenFullLoading:a.screenFullLoading,limitSize:a.limitSize,modelValueString:ye(()=>a.modelValueString),onProgressCb:a.onProgressCb,onChangeCb:a.onChangeCb,uploadRef:r,...W,...N,...k});return $(g,s=>{u("update:modelValueString",ee(s)),u("fileChange")}),$(_,s=>{u("update:modelValueFiles",s),u("fileChange")}),(s,V)=>{var z,D;const v=n("el-icon"),F=n("el-tooltip"),ae=n("el-button"),oe=n("el-image"),le=n("el-progress"),te=n("el-upload"),se=ke("loading");return Be((o(),d("div",{class:"upload-iv",style:Se({width:a.width,height:a.height})},[e(S)?(o(),d("div",{key:0,ref_key:"uploadIvRef",ref:c,class:"upload-iv-thumb"},[a.showDownload?(o(),i(F,{key:0,content:`下载【${e(w)}】`,placement:"top-end"},{default:l(()=>[m("div",_e,[t(v,{size:14,onClick:V[0]||(V[0]=Le=>{var U,L;return a.uploadByBackend?e(Q)((U=e(g))==null?void 0:U[0]):e(B).onDownload((L=e(g))==null?void 0:L[0])})},{default:l(()=>[t(e(re))]),_:1})])]),_:1},8,["content"])):y("",!0),a.showDelete?(o(),i(F,{key:1,content:`删除【${e(w)}】`,placement:"top-end"},{default:l(()=>[t(ae,{icon:e(ce),circle:"",type:"danger",size:"small",class:"thumb-tools-delete",onClick:H},null,8,["icon"])]),_:1},8,["content"])):y("",!0),a.uploadType=="image"?(o(),i(oe,{key:2,class:"upload-iv-thumb__file",src:e(p),"preview-src-list":[e(p)]},{error:l(()=>[m("div",Ve,[t(v,null,{default:l(()=>[t(e(ue))]),_:1})])]),_:1},8,["src","preview-src-list"])):(o(),d("video",P({key:3,controls:""},{...f}),[m("source",{src:e(p),type:`video/${((D=(z=e(p))==null?void 0:z.split("."))==null?void 0:D[1])||"mp4"}`},null,8,ze)],16))],512)):(o(),i(te,P({key:1,ref_key:"uploadImageVideoRef",ref:r,class:"upload-iv-upload",accept:e(b),"show-file-list":!1,action:j.value,"on-success":e(Y),"on-error":e(Z),"on-progress":e(G),"on-change":e(J),"before-upload":e(K)},{...s.$attrs},{data:q.value}),{default:l(()=>[m("div",De,[e(C)?(o(),i(le,{key:1,type:"circle",percentage:e(X)},null,8,["percentage"])):(o(),d(be,{key:0},[t(v,{class:"upload-iv-icon",size:a.iconSize},{default:l(()=>[t(e(pe))]),_:1},8,["size"]),a.btnLabel?(o(),d("p",Fe,Ce(a.btnLabel),1)):y("",!0)],64))])]),tip:l(()=>[we(s.$slots,"tip",{},void 0,!0)]),_:3},16,["accept","action","on-success","on-error","on-progress","on-change","before-upload","data"]))],4)),[[se,A.value?e(C):!1]])}}}),Ee=ie(Ue,[["__scopeId","data-v-1c46d50d"]]);export{Ee as default};

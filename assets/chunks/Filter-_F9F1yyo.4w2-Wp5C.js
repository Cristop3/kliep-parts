import{d as oe,N as re,h as B,g as O,y as ne,ah as ie,j as ue,A as se,D as d,o as u,c as C,r as S,k as F,I as K,w as c,m as y,F as L,e as p,M as V,Z as me,b,E,a as j,O as de,aL as fe,aM as ce}from"./framework.URa763XA.js";import{aQ as pe,o as ve,aM as q,s as ye,c as be}from"./kliep-tools.es.LP6p9N8X.js";import{N as Ie,S as he,M as ge,R as ke}from"../app.kzXXsBQF.js";import{q as Ce,e as Ke,K as Ve,o as _e,R as Be,O as Fe,r as Le,m as $e,L as Re,s as Me,u as Te}from"./default-config-vCTUsqVJ.xfmBKe9X.js";import{x as we,O as Pe}from"./isBoolean-FTy8Y3r3.lwWwqs-V.js";import"./index.UfSCTmkv.js";import"./theme.cz4nT2hu.js";var Oe="[object Map]",Se="[object Set]",Ue=Object.prototype,He=Ue.hasOwnProperty;function Ne(o){if(o==null)return!0;if(_e(o)&&(Be(o)||typeof o=="string"||typeof o.splice=="function"||Fe(o)||Le(o)||$e(o)))return!o.length;var _=Re(o);if(_==Oe||_==Se)return!o.size;if(Me(o))return!Te(o).length;for(var $ in o)if(He.call(o,$))return!1;return!0}const De={class:"filter"},xe={class:"filter-main__form mr10"},Ee={class:"filter-main__btn"},je={class:"filter-main__btn--align"},qe=oe({name:"kd-filter",__name:"Filter",props:{filterName:{default:""},filterList:{default:()=>[]},filterCol:{},filterFieldsColon:{type:Boolean,default:!1},filterQueryCache:{type:Boolean,default:!1},filterDefaultBtn:{type:Boolean,default:!0},filterCache:{type:Boolean,default:!0},filterEnableTools:{type:Boolean}},emits:["filterSearchCb","filterResetCb","filterBeforeMount","filterMounted","filterUnmouted"],setup(o,{expose:_,emit:$}){const A=fe(()=>ce(()=>import("./ToolsBar-kd1E9dNg.fViCiAsf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Q=pe({},Ce,re("kd-filter-table")),s=o,z={...ve[30]},J={},Z={},I=B(),U={input:"",select:"",selectMutiple:[],datePicker:""},H=O(()=>s.filterList.filter(l=>we(l.formItemHidden)?!l.formItemHidden:!(Ke(l.formItemHidden)&&l.formItemHidden())).map(l=>(l.key=`${l.formItemLabel}_${l.formItemKey}`,l))),R=l=>{const a={};return l.reduce((n,i)=>{const{formItemKey:m,formItemType:f,disabled:k,formItemInitValue:v}=i;return!k&&!Ne(v)?n[m]=v:n[m]=U[f]??"",n},a),{...a}},h=B(Pe(H.value)),t=B(R(h.value)),W=B(!1),X=O(()=>h.value.length>24/q.md?{alignItems:"center"}:{}),Y=O(()=>s.filterCol?s.filterCol:q);ne(()=>s.filterList,(l,a)=>{const n={};a==null||a.map(i=>{const{formItemKey:m,formItemType:f,disabled:k}=i;if(k&&(t.value[m]=U[f],f=="datePicker")){const{datePickerReallyKeys:v}=i,[w,P]=v.split(",");t.value[w]="",t.value[P]=""}n[m]=f}),l!=null&&l.some(i=>!n[i==null?void 0:i.formItemKey])&&(t.value=R(s.filterList)),h.value=[...l]},{deep:!0}),ie(()=>g("filterBeforeMount")),ue(()=>g("filterMounted")),se(()=>g("filterUnmouted"));const G=(l="表单项")=>`${l}${s.filterFieldsColon?"：":""}`,ee=l=>[l?{...be,message:""}:{required:!1}],M=(l="表单项",a)=>{switch(a){case"input":return`请输入${l}`;case"select":return`请选择${l}`;case"datePicker":return`请选择${l}`;default:return`请输入${l}`}},le=(l,a,n)=>{if(a){const[i,m]=[...a.split(",")];t.value[i]=(l==null?void 0:l[0])??"",t.value[m]=(l==null?void 0:l[1])??"",n.change&&n.change(l)}},N=l=>{l==null||l.resetFields(),g("filterResetCb",l),t.value=R(s.filterList),D(t.value)},T=()=>{I.value.validate(l=>{if(!l)return!1;const a={...t.value};g("filterSearchCb",a),D(a)})},te=l=>{var a;h.value=l,(a=l==null?void 0:l.filter(n=>n.formItemHidden))==null||a.map(n=>{const{formItemKey:i}=n;I.value.resetFields(i)})},D=l=>ke.emit("filterSendQuery2Table",l),g=$;return _({formRef:I,formValue:t,doSearch:T,doReset:N}),(l,a)=>{const n=d("el-input"),i=d("el-option"),m=d("el-select"),f=d("el-date-picker"),k=d("el-form-item"),v=d("el-col"),w=d("el-row"),P=d("el-form"),x=d("el-button");return u(),C("div",De,[S(l.$slots,"filterHeader",{},void 0,!0),F("div",{class:"filter-main",style:de(X.value)},[F("div",xe,[K(P,{ref_key:"formRef",ref:I,model:t.value},{default:c(()=>[K(w,{gutter:y(ye)[20]},{default:c(()=>[(u(!0),C(L,null,E(h.value,(e,ae)=>(u(),C(L,null,[e.formItemHidden?p("",!0):(u(),b(v,V({key:0},Y.value,{key:`${e.formItemKey}_${ae}`,class:"pb5"}),{default:c(()=>[K(k,{prop:e.formItemKey,label:G(e.formItemLabel),rules:ee(!!e.formItemRequired)},{default:c(()=>[e.formItemType=="input"?(u(),b(n,V({key:0,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:M(e.formItemLabel,"input")},{...z,...e},{onKeydown:me(T,["enter"]),onClick:e==null?void 0:e.click,onBlur:e==null?void 0:e.blur,onInput:e==null?void 0:e.input,onClear:e==null?void 0:e.clear,onChange:e==null?void 0:e.change,onFocus:e==null?void 0:e.focus}),null,16,["modelValue","onUpdate:modelValue","placeholder","onKeydown","onClick","onBlur","onInput","onClear","onChange","onFocus"])):p("",!0),e.formItemType=="select"?(u(),b(m,V({key:1,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:M(e.formItemLabel,"select")},{...J,...e},{onChange:e==null?void 0:e.change,onClear:e==null?void 0:e.clear,onBlur:e==null?void 0:e.blur,onFocus:e==null?void 0:e.focus,onVisibleChange:e==null?void 0:e.visibleChange,onRemoveTag:e==null?void 0:e.removeTag,style:{width:"100%"}}),{default:c(()=>[(u(!0),C(L,null,E(e.selectOptions,r=>(u(),b(i,{key:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value,label:e.selectKeyValueField?typeof e.selectKeyValueField.label=="function"?e.selectKeyValueField.label(r):r[e.selectKeyValueField.label]:r.label,value:e.selectKeyValueField?r[e.selectKeyValueField.value]:r.value},null,8,["label","value"]))),128))]),_:2},1040,["modelValue","onUpdate:modelValue","placeholder","onChange","onClear","onBlur","onFocus","onVisibleChange","onRemoveTag"])):p("",!0),e.formItemType=="datePicker"?(u(),b(f,V({key:2,modelValue:t.value[e.formItemKey],"onUpdate:modelValue":r=>t.value[e.formItemKey]=r,placeholder:M(e.formItemLabel,"datePicker")},{...Z,...e},{onChange:r=>le(r,e.datePickerReallyKeys,e)}),null,16,["modelValue","onUpdate:modelValue","placeholder","onChange"])):p("",!0),e.formItemType=="slot"?S(l.$slots,`filter${y(Ve)(e.formItemKey)}`,V({key:3,modelValue:{value:t.value[e.formItemKey]},updateModelValue:r=>t.value[e.formItemKey]=r},e),void 0,!0):p("",!0)]),_:2},1032,["prop","label","rules"])]),_:2},1040))],64))),256))]),_:3},8,["gutter"])]),_:3},8,["model"])]),F("div",Ee,[F("div",je,[s.filterDefaultBtn?(u(),C(L,{key:0},[K(x,{type:"primary",icon:y(he),loading:W.value,onClick:T},{default:c(()=>[j(" 查询 ")]),_:1},8,["icon","loading"]),K(x,{icon:y(ge),onClick:a[0]||(a[0]=e=>N(I.value))},{default:c(()=>[j(" 重置 ")]),_:1},8,["icon"])],64)):p("",!0),S(l.$slots,"filterBtn",{},void 0,!0),s.filterEnableTools||y(Q).toolsBar?(u(),b(y(A),{key:1,class:"ml12","bar-setting-tool-tip-content":"搜索项设置","bar-setting-popover-check-all-label":"搜索显示","bar-setting-check-label":"formItemLabel","bar-setting-hide-key":"formItemHidden","bar-setting-no-drag-key":"formItemRequired","bar-setting-check-list":H.value,onDynamicListUpdate:te},null,8,["bar-setting-check-list"])):p("",!0)])])],4)])}}}),Ye=Ie(qe,[["__scopeId","data-v-0d2a0319"]]);export{Ye as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/ToolsBar-kd1E9dNg.fViCiAsf.js","assets/chunks/kliep-tools.es.LP6p9N8X.js","assets/chunks/framework.URa763XA.js","assets/chunks/index.UfSCTmkv.js","assets/app.kzXXsBQF.js","assets/chunks/theme.cz4nT2hu.js","assets/chunks/isBoolean-FTy8Y3r3.lwWwqs-V.js","assets/chunks/default-config-vCTUsqVJ.xfmBKe9X.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
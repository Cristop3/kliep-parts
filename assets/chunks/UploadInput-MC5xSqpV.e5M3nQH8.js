import{aU as X,aV as Y}from"./kliep-tools.es.JjaqLF3K.js";import{aA as Z,aB as ee,aC as ae}from"./index-qAyI4RUB.bETfU6ur.js";import{d as oe,N as le,al as ne,h as te,g as t,V as se,y as w,D as s,o as f,c as de,I as n,w as o,m as e,b as D,e as F,k as ie,t as ue,a as re,r as pe,M as ce}from"./framework.fC-vvecU.js";import"./index.zqm2yNl1.js";const fe={class:"upload-input"},ge={class:"upload-input-main"},me=oe({__name:"UploadInput",props:{limitSize:{default:200},screenFullLoading:{type:Boolean,default:!1},loadingType:{default:"progress"},btnLabel:{default:"选择文件"},showDownload:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},link:{type:Boolean},onSuccessCb:{},onErrorCb:{},onProgressCb:{},onChangeCb:{},onBeforeUploadCb:{},modelValueString:{},modelValueFiles:{},uploadByBackend:{type:Boolean}},emits:["update:modelValueString","update:modelValueFiles","fileChange"],setup(U,{emit:L}){const a=U,P=le("kd-upload",()=>{}),{ossUploadBackend:g={},normal:$={},ossUploadFrontend:m={}}=P,{accept:v=".pdf",data:x={}}=ne(),d=te(),B=t(()=>a.loadingType==="loading"),k=t(()=>a.link?"上传":a.btnLabel),y=t(()=>!!(c.value||r.value)),z=t(()=>a.uploadByBackend?g.uploadUrl:A.value),N=t(()=>a.uploadByBackend?x:R.value),I=()=>{p.value=[],u.value="",r.value="",d.value.handleRemove(b)},i=L,{ossBackData:R,ossBackAction:A,events:E}=X(a,m,d),{uploading:c,name:u,url:r,fileList:p,nativeFileList:b,uploadProgress:T,onSuccess:j,onError:q,onProgress:M,onChange:G,onBeforeUpload:H,funcDownloadFile:J,funcUpload2String:K}=Y({uploadByBackend:a.uploadByBackend,accept:v,screenFullLoading:a.screenFullLoading,limitSize:a.limitSize,modelValueString:se(()=>a.modelValueString),onProgressCb:a.onProgressCb,onChangeCb:a.onChangeCb,uploadRef:d,...E,...$,...g});return w(p,l=>{i("update:modelValueString",K(l)),i("fileChange")}),w(b,l=>{i("update:modelValueFiles",l),i("fileChange")}),(l,C)=>{const O=s("el-icon"),h=s("el-tooltip"),_=s("el-button"),Q=s("el-input"),W=s("el-upload");return f(),de("div",fe,[n(Q,{class:"upload-input-input",readonly:"",value:e(u)},{prefix:o(()=>[e(r)&&a.showDownload?(f(),D(h,{key:0,content:`下载【${e(u)}】`,placement:"top-end"},{default:o(()=>[n(O,{class:"el-input__icon",size:14,onClick:C[0]||(C[0]=ve=>{var S,V;return a.uploadByBackend?e(J)((S=e(p))==null?void 0:S[0]):e(m).onDownload((V=e(p))==null?void 0:V[0])})},{default:o(()=>[n(e(ee))]),_:1})]),_:1},8,["content"])):F("",!0)]),suffix:o(()=>[e(r)&&a.showDelete?(f(),D(h,{key:0,content:`删除【${e(u)}】`,placement:"top-end"},{default:o(()=>[n(_,{icon:e(ae),circle:"",type:"danger",size:"small",onClick:I},null,8,["icon"])]),_:1},8,["content"])):F("",!0)]),_:1},8,["value"]),ie("span",ge,[n(W,ce({ref_key:"uploadInputRef",ref:d,accept:e(v),action:z.value,limit:1,"show-file-list":!1,"on-success":e(j),"on-error":e(q),"on-progress":e(M),"on-change":e(G),"before-upload":e(H),disabled:y.value},{...l.$attrs},{data:N.value}),{trigger:o(()=>[n(_,{type:"primary",link:a.link,loading:B.value?e(c):!1,disabled:y.value},{default:o(()=>[re(ue(B.value?k.value:e(c)?`${e(T)}%`:k.value),1)]),_:1},8,["link","loading","disabled"])]),tip:o(()=>[pe(l.$slots,"tip",{},void 0,!0)]),_:3},16,["accept","action","on-success","on-error","on-progress","on-change","before-upload","disabled","data"])])])}}}),Ce=Z(me,[["__scopeId","data-v-54033319"]]);export{Ce as default};
